# KNN Classification

- [Feature](https://en.wikipedia.org/wiki/Feature_(machine_learning))
- [k-nearest neighbors (KNN) algorithm](https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm)
- [Softmax function](https://en.wikipedia.org/wiki/Softmax_function)
- [How to build a Teachable Machine with TensorFlow.js](https://observablehq.com/@nsthorat/how-to-build-a-teachable-machine-with-tensorflow-js)
- [Cosine similarity](https://en.wikipedia.org/wiki/Cosine_similarity)

---

- `index.html`

```html
<!DOCTYPE html>
<html>
  <head>
    <title>ml5.js 연습</title>
    <meta charset="utf-8">
    <script src="https://cdn.jsdelivr.net/npm/p5@1/lib/p5.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/p5@1/lib/addons/p5.sound.min.js"></script>
    <script src="https://unpkg.com/ml5@latest/dist/ml5.min.js"></script>
  </head>

  <body>
    <h1>KNN Classification</h1>
    <script src="sketch.js"></script>
  </body>
</html>
```

---

- `sketch.js` 

```javascript
let features;
let video;

function modelReady() {
  console.log('Model is ready!');
}

function setup() {
  createCanvas(640, 480);
  video = createCapture(VIDEO);
  video.size(640, 480);
  video.hide();
  features = ml5.featureExtractor('MobileNet', modelReady);
}

function draw() {
  image(video, 0, 0);
} 

function mousePressed() {
  let logits = features.infer(video);
  console.log(logits);
  // logits.print();
  // console.log(logits.dataSync());
} 
```

---

- `sketch.js` 

```javascript
let features;
let video;
let knn;

function modelReady() {
  console.log('Model is ready!');
}

function setup() {
  createCanvas(640, 480);
  video = createCapture(VIDEO);
  video.size(640, 480);
  video.hide();
  features = ml5.featureExtractor('MobileNet', modelReady);
  knn = ml5.KNNClassifier();
}

function draw() {
  image(video, 0, 0);
} 

function keyPressed() {
  let logits = features.infer(video);
  // build your own database for 'left' and 'right'
  if (key == 'l') {
    knn.addExample(logits, 'left');
  } else if (key == 'r') {
    knn.addExample(logits, 'right');
  }
} 
```


---

- `sketch.js` 

```javascript
let features;
let video;
let knn;

function modelReady() {
  console.log('Model is ready!');
}

function setup() {
  createCanvas(640, 480);
  video = createCapture(VIDEO);
  video.size(640, 480);
  video.hide();
  features = ml5.featureExtractor('MobileNet', modelReady);
  knn = ml5.KNNClassifier();
}

function draw() {
  image(video, 0, 0);
} 

function keyPressed() {
  let logits = features.infer(video);
  // build your own database for 'left' and 'right'
  if (key == 'l') {
    knn.addExample(logits, 'left');
    console.log('left');
  } else if (key == 'r') {
    knn.addExample(logits, 'right');
    console.log('right');
  }
} 

function mousePressed() {
  if (knn.getNumLabels() > 0) {
    let logits = features.infer(video);
    knn.classify(logits, gotResults);  // callback
  }
}

function gotResults(error, results) {
  if (error) {
    console.error(error);
  } else {
    console.log(results);
  }
}
```


---

- `sketch.js` 

```javascript
let features;
let video;
let knn;
let labelP;
let ready = false;

function modelReady() {
  console.log('Model is ready!');
}

function setup() {
  createCanvas(640, 480);
  video = createCapture(VIDEO);
  video.size(640, 480);
  video.hide();
  features = ml5.featureExtractor('MobileNet', modelReady);
  knn = ml5.KNNClassifier();
  labelP = createP('We need training data');
  labelP.style('font-size', '32pt');
}

function keyPressed() {
  let logits = features.infer(video);
  // build your own database for 'left' and 'right'
  if (key == 'l') {
    knn.addExample(logits, 'left');
    console.log('left');
  } else if (key == 'r') {
    knn.addExample(logits, 'right');
    console.log('right');
  } else if (key == 'u') {
    knn.addExample(logits, 'up');
    console.log('up');
  } else if (key == 'd') {
    knn.addExample(logits, 'down');
    console.log('down');
  }

} 




function goClassify() {
  let logits = features.infer(video);
  knn.classify(logits, function (error, results) {
    if (error) {
      console.error(error);
    } else {
      labelP.html(results.label);
      goClassify();
    }
  });
}

function draw() {
  image(video, 0, 0);

  if (!ready && knn.getNumLabels() > 0) {
    ready = true;
    goClassify();
  }
} 
```



---

- `sketch.js` 

```javascript
let features;
let video;
let knn;
let labelP;
let ready = false;

function modelReady() {
  console.log('Model is ready!');
}

function setup() {
  createCanvas(640, 480);
  video = createCapture(VIDEO);
  video.size(640, 480);
  video.hide();
  features = ml5.featureExtractor('MobileNet', modelReady);
  knn = ml5.KNNClassifier();
  labelP = createP('We need training data');
  labelP.style('font-size', '32pt');
}

function keyPressed() {
  let logits = features.infer(video);
  // build your own database for 'left' and 'right'
  if (key == 'l') {
    knn.addExample(logits, 'left');
    console.log('left');
  } else if (key == 'r') {
    knn.addExample(logits, 'right');
    console.log('right');
  } else if (key == 'u') {
    knn.addExample(logits, 'up');
    console.log('up');
  } else if (key == 'd') {
    knn.addExample(logits, 'down');
    console.log('down');
  } else if (key == 's') {
    knn.save('model.json');
  }

} 
 
function goClassify() {
  let logits = features.infer(video);
  knn.classify(logits, function (error, results) {
    if (error) {
      console.error(error);
    } else {
      labelP.html(results.label);
      goClassify();
    }
  });
}

function draw() {
  image(video, 0, 0);

  if (!ready && knn.getNumLabels() > 0) {
    ready = true;
    goClassify();
  }
} 
```


---

- `sketch.js` 

```javascript

```


---

- `sketch.js` 

```javascript

```

