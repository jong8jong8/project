# ADSR Envelope

- [p5.sound library](https://p5js.org/reference/#/libraries/p5.sound)
- [Free Sound](https://freesound.org/)
- [ADSR Envelope](https://en.wikipedia.org/wiki/Synthesizer#Attack_Decay_Sustain_Release_.28ADSR.29_envelope)
- [Scientific pitch notation](https://en.wikipedia.org/wiki/Scientific_pitch_notation)

---
 
- `index.html`

```html
<!DOCTYPE html>
<html>
  <head>
    <title>Sound 연습</title>
    <meta charset="utf-8">
    <script src="https://cdn.jsdelivr.net/npm/p5@1/lib/p5.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/p5@1/lib/addons/p5.sound.min.js"></script>
  </head>

  <body>
    <h1>ADSR Envelope</h1>
    <script src="sketch.js"></script>
  </body>
</html>
```

---

- `sketch.js`

```javascript
let wave;
let button;
let playing = false;
let env;

function setup() {
    createCanvas(100, 100);

    env = new p5.Envelope();
    env.setADSR(0.05, 0.1, 0.5, 1);
    env.setRange(1.2, 0);

    wave = new p5.Oscillator('sine');
    wave.start();
    wave.amp(env);
    wave.freq(440);  // hearing range (가청 범위): 20 ~ 20,000 Hz

    button = createButton('play');
    button.mousePressed(toggle);
}

function draw() {
    if (playing) {
        background(255, 0, 255);
    } else {
        background(51);
    }
}

function toggle() {
    env.play();
}
```


---

- `sketch.js` (music keyboard)

```javascript
// Coding in p5.js with Sid Singh
// https://www.youtube.com/watch?v=ShCNc8t9kYs
var notes = [ 60,62,64,65,67,69,71 ];
var osc;
function setup() {
  createCanvas(720, 400);
osc = new p5.TriOsc();
osc.start();
osc.amp(0);
}
function playNote(note,duration) {
osc.freq(midiToFreq(note));
osc.fade(0.5,0.2);
    if(duration) {
      setTimeout(function() {
        osc.fade(0,0.2);
}, duration-50);
}
}
function draw() {
var w = width / notes.length;
for (var i = 0; i < notes.length; i++) {
var x = i * w;
if(mouseX > x && mouseX < x + w && mouseY < height) {
  if(mouseIsPressed) {
fill(100,255,200);
  } else{
    fill(127);
  }
} else {
  fill(200);
}
rect(x,0,w-1,height-1);
 }
}
function mousePressed() {
  var key = floor(map(mouseX,0,width,0,notes.length));
  playNote(notes[key]);
}
function mouseReleased() {
  osc.fade(0,0.5);
}
```
